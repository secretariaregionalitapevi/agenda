<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Calendário CCB Regional Itapevi 2026</title>

<style>
:root{
  --ink:#111;
  --line:#222;
  --red:#c81515;
  --paper:#fff;
}
*{box-sizing:border-box}
body{margin:0;background:#f3f3f3;font-family:Tahoma, Arial, sans-serif;color:var(--ink)}

.controls{
  position:sticky;top:10px;z-index:50;
  background:#fff;border:1px solid #d0d0d0;border-radius:12px;
  padding:10px 14px;display:flex;gap:14px;
  justify-content:center;align-items:center;
  width:fit-content;margin:10px auto 14px;
}
.controls select,.controls button{
  font:inherit;border:1px solid #c8c8c8;border-radius:10px;
  padding:8px 10px;background:#fff;font-weight:700;
}

.sheet{
  background:#fff;
  width:210mm;min-height:297mm;
  margin:0 auto 18px auto;
  padding:18mm 16mm 14mm;
  page-break-after:always;
}

.month-name{
  text-align:right;font-size:26px;font-weight:800;
  border-top:2px solid var(--line);padding-top:6px;
}

.table{margin-top:10px;border-top:1px solid var(--line)}
.r{
  display:grid;grid-template-columns:92px 1fr;
  border-bottom:1px solid var(--line);
}
.left{
  border-right:1px solid var(--line);
  padding:4px 8px;font-weight:700;
}
.left.sun{color:var(--red)}
.right{
  padding:4px 10px;
  display:flex;flex-direction:column;
  font-size:12px;
}
.evt{line-height:1.15}
.evt.red{color:var(--red);font-weight:800}

/* separador entre eventos do mesmo dia */
.right .evt + .evt{
  border-top:1px solid var(--line);
  margin-top:2px;
  padding-top:2px;
}

@media print{
  .controls{display:none}
  body{background:#fff}
  .sheet{box-shadow:none}
}
</style>
</head>

<body>

<div class="controls">
  <select id="monthSelect">
    <option value="all">Todos</option>
    <option value="2026-01">Janeiro</option>
    <option value="2026-02">Fevereiro</option>
    <option value="2026-03">Março</option>
    <option value="2026-04">Abril</option>
    <option value="2026-05">Maio</option>
    <option value="2026-06">Junho</option>
    <option value="2026-07">Julho</option>
    <option value="2026-08">Agosto</option>
    <option value="2026-09">Setembro</option>
    <option value="2026-10">Outubro</option>
    <option value="2026-11">Novembro</option>
    <option value="2026-12">Dezembro</option>
  </select>
  <button onclick="window.print()">Imprimir / Salvar PDF</button>
</div>

<div id="calendario"></div>

<script>
const PUBLISHED_PUBHTML_URL =
  "COLE_AQUI_O_LINK_PUBLICADO_DO_SHEETS";

const CSV_URL = PUBLISHED_PUBHTML_URL
  .replace("pubhtml", "pub")
  + "&output=csv";

fetch(CSV_URL)
  .then(r => r.text())
  .then(csv => {
    const linhas = csv.split("\n").slice(1);
    const eventos = {};

    linhas.forEach(l => {
      const [data,hora,evento,destaque] = l.split(",").map(v=>v?.trim());
      if(!data) return;

      if(!eventos[data]) eventos[data]=[];
      eventos[data].push({hora,evento,destaque});
    });

    render(eventos);
  });

function render(eventos){
  const cont = document.getElementById("calendario");

  Object.keys(eventos).forEach(data=>{
    const [d,m,a] = data.split("/");
    const sheet = document.createElement("section");
    sheet.className="sheet";

    sheet.innerHTML = `
      <div class="month-name">${m}/${a}</div>
      <div class="table">
        <div class="r">
          <div class="left">${d}</div>
          <div class="right"></div>
        </div>
      </div>
    `;

    const right = sheet.querySelector(".right");

    eventos[data].forEach(ev=>{
      const div = document.createElement("div");
      div.className="evt";
      div.textContent = `${ev.hora} - ${ev.evento}`;
      if(ev.destaque && ev.destaque.toUpperCase()==="SIM"){
        div.classList.add("red");
      }
      right.appendChild(div);
    });

    cont.appendChild(sheet);
  });
}
</script>

</body>
</html>
